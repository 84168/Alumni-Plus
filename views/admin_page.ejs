<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSE Alumni Admin Dashboard</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f7fa;
            color: #333;
        }

        .dashboard {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 25%;
            background: #2d3748;
            color: white;
            padding: 0;
        }

        .logo {
            padding: 24px;
            border-bottom: 1px solid #4a5568;
        }

        .logo h2 {
            color: #63b3ed;
            font-size: 20px;
        }

        .nav-menu {
            padding: 16px 0;
        }

        .nav-item {
            display: block;
            width: 100%;
            padding: 12px 24px;
            background: none;
            border: none;
            color: #cbd5e0;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
        }

        .nav-item:hover {
            background: #4a5568;
            color: white;
        }

        .nav-item.active {
            background: #3182ce;
            color: white;
            border-right: 3px solid #63b3ed;
        }

        .badge {
            background: #e53e3e;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            margin-left: auto;
        }

        /* Main Content */
        .main-content {

            padding: 24px;

        }

        .fix {
            /* background-color: red; */
            display: flex;
            flex-direction: column;
            width: 100%;
            /* margin: auto; */
        }

        .b {
            display: block;
        }

        .header {
            background: white;
            padding: 16px 24px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .stat-number {
            font-size: 28px;
            font-weight: bold;
            color: #3182ce;
        }

        .stat-label {
            color: #718096;
            margin-top: 4px;
        }

        .content-section {
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .section-header {
            padding: 16px 24px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #3182ce;
            color: white;
        }

        .btn-primary:hover {
            background: #2c5aa0;
        }

        .btn-success {
            background: #38a169;
            color: white;
        }

        .btn-danger {
            background: #e53e3e;
            color: white;
        }

        .btn-sm {
            padding: 4px 8px;
            font-size: 12px;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th,
        .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }

        .table th {
            background: #f7fafc;
            font-weight: 600;
            color: #4a5568;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-pending {
            background: #fed7d7;
            color: #c53030;
        }

        .status-approved {
            background: #c6f6d5;
            color: #276749;
        }

        .status-verified {
            background: #bee3f8;
            color: #2c5aa0;
        }

        .hidden {
            display: none;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            margin-bottom: 4px;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            font-size: 14px;
        }

        .form-control:focus {
            outline: none;
            border-color: #3182ce;
            box-shadow: 0 0 0 3px rgba(49, 130, 206, 0.1);
        }

        textarea.form-control {
            resize: vertical;
            min-height: 100px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .modal-content {
            background: white;
            margin: 50px auto;
            padding: 24px;
            width: 90%;
            max-width: 500px;
            border-radius: 8px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #718096;
        }
.try{
 display:flex;
}
        .action-buttons {
            display: flex;
            gap: 8px;
        }


        /* Modal backdrop */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            /* semi-transparent overlay */
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            transition: opacity 0.3s ease;
        }

        /* Modal content box */
        .modal-content {
            background-color: #ffffff;
            padding: 30px 40px;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
            width: 500px;
            max-width: 90%;
            position: relative;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        /* Close button */
        .close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 22px;
            font-weight: bold;
            color: #888;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .close:hover {
            color: #333;
        }

        /* Heading */
        .modal-content h2 {
            margin-top: 0;
            font-size: 24px;
            color: #2c3e50;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }

        /* Info labels */
        .modal-content p {
            margin: 15px 0;
            font-size: 16px;
            color: #34495e;
        }

        .modal-content span {
            font-weight: 500;
            color: #2c3e50;
        }

        #announcement-modal .modal-content form {
            margin-top: 50px;
            margin-bottom: 60px;
            height: 54vh;
            /* 54% of the viewport height */
            overflow-y: auto;
            /* enables scrolling if content exceeds height */
            padding-right: 10px;
            /* optional: prevents scrollbar from overlapping content */

        }
        

/* Main Container */
.fix {
    width: 100%;
    display: flex;
    flex-direction: column;
}

.fix .b.main-content {
    width: 100%;
    display: flex;
    flex-direction: column;
}

/* Header - Vertical Linear Layout */
.fix .header {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 12px;
    padding: 24px;
    background-color: #ffffff;
    border-bottom: 1px solid #e2e8f0;
    width: 100%;
    box-sizing: border-box;
}

/* Page Title */
.fix .header h1 {
    margin: 0;
    font-size: 28px;
    font-weight: 700;
    color: #1a202c;
    line-height: 1.2;
    order: 1;
}

/* Welcome Message */
.fix .header > div {
    margin: 0;
    order: 2;
}

.fix .header > div span {
    font-size: 16px;
    color: #4a5568;
    font-weight: 500;
    display: block;
}

/* Content Sections */
.fix .main-content > div:not(.header) {
    width: 100%;
    padding: 0;
    margin: 0;
}

/* Section containers */
[id$="-section"] {
    width: 100%;
    display: flex;
    flex-direction: column;
    min-height: calc(100vh - 120px);
}

[id$="-section"].hidden {
    display: none !important;
}

/* Responsive adjustments */
@media (min-width: 768px) {
    .fix .header {
        padding: 32px 40px;
        gap: 16px;
    }
    
    .fix .header h1 {
        font-size: 32px;
    }
    
    .fix .header > div span {
        font-size: 18px;
    }
}

@media (min-width: 1024px) {
    .fix .header {
        padding: 40px 48px;
        gap: 20px;
    }
}

/* Optional: Add subtle animation for content changes */
.fix .header h1 {
    transition: all 0.2s ease-in-out;
}

/* Ensure proper spacing for dynamic content */
.fix .header {
    min-height: 80px;
    justify-content: center;
}

    </style>
</head>

<body>
    <div class="dashboard">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <h2>CSE Alumni Admin</h2>
            </div>
            <nav class="nav-menu">
                <button class="nav-item active" onclick="showSection('overview')">
                    üìä Overview
                </button>
                <button class="nav-item" onclick="showSection('user-verification')">
                    üë• User Verification <span class="badge">
                        <%=countUserVerification%>
                    </span>
                </button>
                <button class="nav-item" onclick="showSection('student-needs')">
                    üìù Student Needs <span class="badge">
                        <%=supportCount%>
                    </span>
                </button>
                <button class="nav-item" onclick="showSection('mentorship')">
                    ü§ù Mentorship Requests <span class="badge">
                        <%=mentorshipCount%>
                    </span>
                </button>
                <button class="nav-item" onclick="showSection('announcements')">
                    üì¢ Announcements
                </button>
                <button class="nav-item" onclick="showSection('sessions')">
                    üìÖ Mentorship Sessions
                </button>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="fix">
            <div class="try">
            <div class="b main-content">
                <div class="header">
                    <h1 id="page-title">Dashboard Overview</h1>
                    <div>
                        <span>Welcome, Admin</span>
                    </div>
                </div>

                <!-- Overview Section -->
                <div id="overview-section">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number">
                                <%=countUserVerification%>
                            </div>
                            <div class="stat-label">Pending User Verifications</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">
                                <%=supportCount%>
                            </div>
                            <div class="stat-label">Student Needs to Review</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">
                                <%=mentorshipCount%>
                            </div>
                            <div class="stat-label">Mentorship Requests</div>
                        </div>
                        <!-- <div class="stat-card">
                        <div class="stat-number">6</div>
                        <div class="stat-label">Active Sessions</div>
                    </div> -->
                    </div>

                    <div class="content-section">
                        <div class="section-header">
                            <h3>Recent Activity</h3>
                        </div>
                        <div style="padding: 24px;">
                            <p>‚Ä¢ New alumni verification request from John Doe (Class of 2020)</p>
                            <p>‚Ä¢ Student Alice Brown requested internship guidance</p>
                            <p>‚Ä¢ Mentorship session scheduled between Emma Watson and John Matrix</p>
                            <p>‚Ä¢ 3 new student registrations pending approval</p>
                        </div>
                    </div>
                </div>

                <!-- User Verification Section -->
                <div id="user-verification-section" class="hidden">
                    <div class="content-section">
                        <div class="section-header">
                            <h3>User Verification Requests</h3>
                            <!-- <button class="btn btn-primary" onclick="showModal('bulk-verify')">Bulk Actions</button> -->
                        </div>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Requested For Role</th>
                                    <th>Email</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% row1.forEach((r , idx)=> { %>
                                    <tr>
                                        <td>
                                            <%=r.Full_Name%>
                                        </td>
                                        <td>
                                            <%=r.Role%>
                                        </td>
                                        <td>
                                            <%=r.Email_ID%>
                                        </td>
                                        <td><span class="status-badge status-pending">Pending</span></td>
                                        <td class="action-buttons">
                                            <button class="btn btn-success btn-sm"
                                                style="background-color: cornflowerblue;"
                                                onclick="openUserCard('modal-<%= idx %>')">View Request</button>

                                            <form action="/HandleUserRequest" method="post"
                                                onsubmit="return setAction(this)">
                                                <input type="hidden" name="ID" value="<%= r.ID %>">
                                                <input type="hidden" name="action" value="">
                                                <!-- Will be set dynamically -->

                                                <button type="submit" class="btn btn-success btn-sm"
                                                    onclick="this.form.action.value='approve'">‚úì Approve</button>
                                                <button type="submit" class="btn btn-danger btn-sm"
                                                    onclick="this.form.action.value='reject'">‚úó Reject</button>
                                            </form>
                                        </td>
                                    </tr>


                                    <!-- Individual Modal for Each Request -->
                                    <div id="modal-<%= idx %>" class="modal" style="display:none;">
                                        <div class="modal-content">
                                            <span class="close"
                                                onclick="closeUserCard('modal-<%= idx %>')">&times;</span>
                                            <h2>Request Information</h2>
                                            <p><strong>Name:</strong>
                                                <%= r.Full_Name %>
                                            </p>
                                            <p><strong>Email:</strong>
                                                <%= r.Email_ID %>
                                            </p>
                                            <p><strong>Contact:</strong>
                                                <%= r.Contact_No %>
                                            </p>
                                            <p><strong>Requested For Role:</strong>
                                                <%= r.Role %>
                                            </p>
                                            <p><strong>Course:</strong>
                                                <%= r.Course %>
                                            </p>
                                            <p><strong>User File:</strong>
                                                <% if (r.User_ID) { %>
                                                    <a href="/<%= r.User_ID %>" target="_blank">View Uploaded File</a>
                                                    <% } else { %>
                                                        <span>No file uploaded</span>
                                                        <% } %>
                                            </p>

                                        </div>
                                    </div>
                                    <% }) %>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Student Needs Section -->
                <div id="student-needs-section" class="hidden">
                    <div class="content-section">
                        <div class="section-header">
                            <h3>Student Needs Verification</h3>
                            <!-- <button class="btn btn-primary" onclick="showModal('add-need')">Add Need Category</button> -->
                        </div>
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Student</th>
                                    <th>Title</th>
                                    <th>Need Description</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% rows.forEach((r, index)=> { %>
                                    <tr>
                                        <td>
                                            <%= r.Full_Name %>
                                        </td>
                                        <td>
                                            <%= r.Request_Title %>
                                        </td>
                                        <td>
                                            <%= r.Request_Description %>
                                        </td>
                                        <td><span class="status-badge status-pending">Pending</span></td>
                                        <td class="action-buttons">
                                            <button class="btn btn-success btn-sm"
                                                style="background-color: cornflowerblue;"
                                                onclick="openRequestCard('Need_modal-<%= index %>')">View
                                                Request</button>

                                            <form action="/HandleSupportRequest" method="post"
                                                onsubmit="return setAction(this)">
                                                <input type="hidden" name="Enrollment_No"
                                                    value="<%= r.Enrollment_No %>">
                                                <input type="hidden" name="action" value="">
                                                <!-- Will be set dynamically -->

                                                <button type="submit" class="btn btn-success btn-sm"
                                                    onclick="this.form.action.value='approve'">‚úì Approve</button>
                                                <button type="submit" class="btn btn-danger btn-sm"
                                                    onclick="this.form.action.value='reject'">‚úó Reject</button>
                                            </form>
                                        </td>
                                    </tr>


                                    <!-- Individual Modal for Each Request -->
                                    <div id="Need_modal-<%= index %>" class="modal" style="display:none;">
                                        <div class="modal-content">
                                            <span class="close"
                                                onclick="closeRequestCard('Need_modal-<%= index %>')">&times;</span>
                                            <h2>Request Information</h2>
                                            <p><strong>Name:</strong>
                                                <%= r.Full_Name %>
                                            </p>
                                            <p><strong>Email:</strong>
                                                <%= r.Email_ID %>
                                            </p>
                                            <p><strong>Contact:</strong>
                                                <%= r.Contact_no %>
                                            </p>
                                            <p><strong>Description:</strong>
                                                <%= r.Request_Description %>
                                            </p>
                                        </div>
                                    </div>
                                    <% }) %>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Mentorship Section -->
                <div id="mentorship-section" class="hidden">
                    <div class="content-section">
                        <div class="section-header">
                            <h3>Mentorship Requests</h3>
                            <button class="btn btn-primary" id="Schedule_Form">Schedule Session</button>
                            <button class="btn btn-primary" id="Cancel_Form">Cancel</button>
                        </div>
                        <table class="table" id="table">
                            <thead>
                                <tr>
                                    <th>Student</th>
                                    <th>Categories</th>
                                    <th>Reason</th>
                                    <th>Preffered Mode</th>
                                    <!-- <th>Actions</th> -->
                                </tr>
                            </thead>
                            <tbody>
                                <% mentorshipRequests.forEach((req, index)=> { %>
                                    <tr>
                                        <td>
                                            <%= req.Full_Name %>
                                        </td>
                                        <td>
                                            <%= req.Mentorship_Categories %>
                                        </td>
                                        <td>
                                            <%= req.Reason %>
                                        </td>
                                        <td>
                                            <%= req.Mode %>
                                        </td>

                                        <!-- <td class="action-buttons">
                                            <button class="btn btn-primary btn-sm"
                                                onclick="scheduleSession('<%= req.Enrollment_No %>')">üìÖ
                                                Schedule</button>
                                        </td> -->
                                    </tr>
                                    <% }) %>
                            </tbody>
                        </table>

                        <!-- SESSION FORM -->
                        <form id="sessionForm" action="/schedule-session" method="POST">
                            <div class="form-grid"> <!-- Session Title -->
                                <div class="form-group form-group-full"> <label for="sessionTitle">Session Title <span
                                            class="required">*</span></label> <input type="text" id="sessionTitle"
                                        name="sessionTitle" class="form-control"
                                        placeholder="e.g., Career Guidance in Software Development" required> </div>
                                <!-- Mentor/Alumni -->
                                <div class="form-group"> <label for="mentorId">Mentor/Alumni <span
                                            class="required">*</span>
                                    </label>
                                    <input type="text" name="Alumni">
                                </div>


                                <!-- Session Description -->
                                <div class="form-group form-group-full">
                                    <label for="sessionDescription">Session Description <span
                                            class="required">*</span></label>
                                    <textarea id="sessionDescription" name="Description" class="form-control" rows="4"
                                        placeholder="Provide a brief overview of the session, topics to be covered, and expected outcomes."
                                        required></textarea>
                                </div>
                                <!-- Session Date -->
                                <div class="form-group">
                                    <label for="sessionDate">Session Date <span class="required">*</span></label>
                                    <input type="date" id="sessionDate" name="Date" class="form-control" required>
                                </div>

                                <!-- Duration -->
                                <div class="form-group">
                                    <label for="sessionDuration">Duration
                                        <span class="required">*</span>
                                    </label>
                                    <input type="text" id="sessionDuration" name="Duration" class="form-control"
                                        required>
                                </div>
                            </div>

                            <!-- Mode -->
                            <div class="form-group form-group-full"> <label>Session Mode <span
                                        class="required">*</span></label>
                                <div class="radio-group">
                                    <div class="radio-item"> <input type="radio" id="online" name="mode" value="Online"
                                            required onchange="toggleVenue()"> <label for="online">üåê Online</label>
                                    </div>
                                    <div class="radio-item"> <input type="radio" id="inPerson" name="mode"
                                            value="Offline" required onchange="toggleVenue()"> <label for="inPerson">üè¢
                                            In-Person</label>
                                    </div>
                                    <div class="radio-item"> </div>
                                </div>
                            </div> 
                            <!-- Meeting Link -->
                            <div class="form-group venue-toggle" id="meetingLinkGroup"> <label for="meetingLink">Meeting
                                    Link/ID</label> <input type="url" id="meetingLink" name="meetingLink"
                                    class="form-control" placeholder="https://zoom.us/j/123456789 or Meeting ID"> </div>
                            <!-- Venue (for in-person/hybrid) -->
                            <div class="form-group venue-toggle" id="physicalVenue"> <label
                                    for="venue">Venue/Location</label> <input type="text" id="venue" name="venue"
                                    class="form-control"
                                    placeholder="Don't Fill if Mode is Online">
                            </div>

                            <!-- Target Audience -->
                            <div class="form-group"> <label for="targetAudience">Target Audience</label> <select
                                    id="targetAudience" name="targetAudience" class="form-control">
                                    <option value="all">All Students</option>
                                    <option value="first-year">First Year Students</option>
                                    <option value="second-year">Second Year Students</option>
                                    <option value="third-year">Third Year Students</option>
                                    <option value="final-year">Final Year Students</option>
                                    <option value="postgraduate">Postgraduate Students</option>
                                    <option value="recent-graduates">Recent Graduates</option>
                                </select> </div> <!-- Registration Deadline -->
                            <div class="form-group"> <label for="registrationDeadline">Registration Deadline</label>
                                <input type="datetime-local" id="registrationDeadline" name="registrationDeadline"
                                    class="form-control">
                            </div>

                            <div class="btn-group"><button type="submit" class="btn btn-primary">üìÖ Schedule
                                    Session</button> </div>
                        </form>
                    </div>
                </div>

            </div>

            <!-- Announcements Section -->
            <div id="announcements-section" class="b hidden">
                <div class="content-section">
                    <div class="section-header">
                        <h3>Post Announcements</h3>
                        <button class="btn btn-primary" onclick="showModal('announcement')">Create Announcement</button>
                    </div>
                    <% announcement.forEach((req)=> { %>
                        <div style="padding: 24px;">
                            <div
                                style="border: 1px solid #e2e8f0; border-radius: 6px; padding: 16px; margin-bottom: 16px;">

                                <div id="title-<%= req.ID %>">
                                    <h4>
                                        <%= req.Title %>
                                    </h4>
                                </div>

                                <div id="meta-<%= req.ID %>" style="color: #718096; margin: 8px 0;">
                                    üìÖ Posted on <%= req.Posted_On %> ‚Ä¢ üëÅÔ∏è Visible to: <%= req.Visibility %>
                                </div>

                                <div id="desc-<%= req.ID %>">
                                    <p>
                                        <%= req.Description %>
                                    </p>
                                </div>

                                <% if (req.Attachment_Url) { %>
                                    <p style="margin-top: 12px;">
                                        üìé Attachment:
                                        <a href="<%= req.Attachment_Url %>" target="_blank" style="color: #3182ce;">
                                            View File
                                        </a>
                                    </p>
                                    <% } %>

                                        <% if (req.Important_Links) { const links=req.Important_Links.split(','); %>
                                            <div id="links-<%= req.ID %>" style="margin-top: 12px;">
                                                üîó Important Links:
                                                <ul style="padding-left: 20px;">
                                                    <% links.forEach(link=> { %>
                                                        <li>
                                                            <a href="<%= link.trim() %>" target="_blank"
                                                                style="color: #3182ce;">
                                                                <%= link.trim() %>
                                                            </a>
                                                        </li>
                                                        <% }) %>
                                                </ul>
                                            </div>
                                            <% } %>

                                                <div style="margin-top: 12px;" id="actions-<%= req.ID %>">
                                                    <button class="btn btn-primary btn-sm"
                                                        onclick="editAnnounceCard(<%= req.ID %>, `<%= req.Title %>`, `<%= req.Description %>`, `<%= req.Posted_On %>`, `<%= req.Visibility %>`, `<%= req.Important_Links %>`)">
                                                        Edit
                                                    </button>
                                                    <button class="btn btn-danger btn-sm" style="margin-left: 8px;"
                                                        onclick="deleteAnnounceCard(<%= req.ID %>)">
                                                        Delete
                                                    </button>
                                                </div>
                            </div>
                        </div>
                        <% }) %>


                </div>
            </div>
            </div>
        </div>

        <!-- Modals -->
        <div id="announcement-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Create Announcement</h3>
                    <button class="close" onclick="closeModal('announcement-modal')">&times;</button>
                </div>
                <form id="announcement-form" action="/announcement" method="post" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="title">Title</label>
                        <input type="text" id="title" name="Title" class="form-control" placeholder="Announcement title"
                            required>
                    </div>

                    <div class="form-group">
                        <label for="description">Content</label>
                        <textarea id="description" name="Description" class="form-control"
                            placeholder="Write your announcement..." required></textarea>
                    </div>

                    <div class="form-group">
                        <label for="important_links">Important Links</label>
                        <input type="text" id="important_links" name="Important_Links" class="form-control"
                            placeholder="Add URLs separated by commas">
                    </div>

                    <div class="form-group">
                        <label for="posted_on">Posted On</label>
                        <input type="date" id="posted_on" name="Posted_On" class="form-control"
                            value="<?= date('Y-m-d') ?>">
                    </div>

                    <div class="form-group">
                        <label for="attachment">Attach PDF or Image</label>
                        <input type="file" id="attachment" name="Attachment_Url" class="form-control"
                            accept=".pdf,image/*">
                    </div>

                    <div class="form-group">
                        <label for="visibility">Visibility</label>
                        <select id="visibility" name="Visibility" class="form-control">
                            <option value="All Users" selected>All Users</option>
                            <option value="Alumni">Alumni Only</option>
                            <option value="Student">Students Only</option>
                            <option value="Faculty">Faculty Only</option>
                        </select>
                    </div>

                    <div style="display: flex; gap: 12px; justify-content: flex-end;">
                        <button type="button" class="btn" onclick="closeModal('announcement-modal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" onclick="createAnnouncement()">Post
                            Announcement</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Sessions Section -->

        <div id="sessions-section" class="hidden">
            <div class="liner">
                <div class="content-section" id="liner">
                    <div style="padding: 24px;">
                        <div
                            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px;">

                            <!-- Session Cards -->
                            <% mentorshipSessions.forEach( (req)=>{ %>
                                <div style="border: 1px solid #e2e8f0; border-radius: 6px; padding: 16px;">
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <h4 id="topic-<% req.Session_ID %>">
                                            <%=req.Topic%>
                                        </h4>
                                        <span id="Audience-<% req.Session_ID %>"
                                            style="font-size: 0.85rem; background-color: #edf2f7; padding: 4px 8px; border-radius: 4px;">Target:
                                            <%=req.Target_Audience %>
                                        </span>
                                    </div>
                                    <table style="width: 100%; margin-top: 8px;">
                                        <tr>
                                            <td id="mentor-<% req.Session_ID %>"><strong>Mentor:</strong>
                                                <%=req.Alumni%>
                                            </td>
                                            <!-- <td><strong>Students:</strong> 8 enrolled</td> -->
                                        </tr>
                                        <tr>
                                            <td id="date-<% req.Session_ID %>"><strong>Date:</strong>
                                                <%=req.Session_Date%>
                                            </td>
                                            <td id="duration-<% req.Session_ID %>"><strong>Duration:</strong>
                                                <%=req.Duration%>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td id="mode-<% req.Session_ID %>"><strong>Mode:</strong>
                                                <%=req.Mode%>
                                            </td>
                                            <td id="venue-<% req.Session_ID %>"><strong>Venue:</strong>
                                                <%=req.Venue%>
                                            </td>
                                        </tr>
                                        <tr>
                                            <!-- <td><strong>Topic:</strong> Career Planning & Strategy</td> -->
                                            <td id="deadline-<% req.Session_ID %>"><strong>Registration
                                                    Deadline:</strong>
                                                <%=req.Registration_Deadline%>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td id="description-<% req.Session_ID %>" colspan="2">
                                                <strong>Description:</strong>
                                                <%=req.Description%>
                                            </td>
                                        </tr>
                                        <!-- <tr>
                                <td colspan="2"><strong>Status:</strong> <span class="status-badge status-pending">Pending</span></td>
                            </tr> -->
                                    </table>
                                    <div style="margin-top: 12px;" id="actions-<%=req.Session_ID%>">
                                        <button class="btn btn-danger btn-sm delete-btn"
                                            id="delete-<%= req.Session_ID %>"
                                            style="margin-left: 8px;" onclick="deleteSession(`<%= req.Session_ID %>`)">Delete</button>
                                    </div>

                                </div>
                                <% })%>
                        </div>
                    </div>
                </div>
            </div>
        </div>



    </div>


    <script>
        const announcement = document.getElementById("announcement-modal");
        const form = document.getElementById("sessionForm");
        const Schedule_Form = document.getElementById("Schedule_Form");
        const table = document.getElementById("table");
        const Cancel_Form = document.getElementById("Cancel_Form");

        form.style.display = "none";
        Cancel_Form.style.display = "none";
        announcement.style.display = "none";

        Schedule_Form.addEventListener('click', () => {
            Schedule_Form.style.display = "none";
            form.style.display = "block";
            table.style.display = "none";
            Cancel_Form.style.display = "block";
        })

        Cancel_Form.addEventListener('click', () => {
            Schedule_Form.style.display = "block";
            form.style.display = "none";
            table.style.display = "block";
            Cancel_Form.style.display = "none";
        })
        function openUserCard(id) {
            document.getElementById(id).style.display = "block";
        }
        function closeUserCard(id) {
            document.getElementById(id).style.display = "none";
        }
        function openRequestCard(id) {
            document.getElementById(id).style.display = "block";
        }
        function closeRequestCard(id) {
            document.getElementById(id).style.display = "none";
        }

        // Optional: Close modal when clicking outside
        window.onclick = function (event) {
            const modals = document.querySelectorAll(".modal");
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = "none";
                }
            });
        }


        function showSection(sectionName) {
            // Hide all sections
            const sections = ['overview', 'user-verification', 'student-needs', 'mentorship', 'announcements', 'sessions'];
            sections.forEach(section => {
                document.getElementById(section + '-section').classList.add('hidden');
            });

            // Remove active class from all nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });

            // Show selected section
            document.getElementById(sectionName + '-section').classList.remove('hidden');

            // Add active class to clicked nav item
            event.target.classList.add('active');

            // Update page title
            const titles = {
                'overview': 'Dashboard Overview',
                'user-verification': 'User Verification',
                'student-needs': 'Student Needs',
                'mentorship': 'Mentorship Requests',
                'announcements': 'Announcements',
                'sessions': 'Mentorship Sessions'
            };
            document.getElementById('page-title').textContent = titles[sectionName];
        }

        function showModal(modalType) {
            document.getElementById(modalType + '-modal').style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }



        document.addEventListener("DOMContentLoaded", () => {
            const onlineRadio = document.getElementById("online");
            const inPersonRadio = document.getElementById("inPerson");
            const meetingLinkGroup = document.getElementById("meetingLinkGroup");
            const physicalVenue = document.getElementById("physicalVenue");
            const addressGroup = document.getElementById("addressGroup");

            const startTimeInput = document.getElementById("startTime");
            const endTimeInput = document.getElementById("endTime");
            const durationInfo = document.querySelector(".duration-info");

            function toggleVenue() {
                if (onlineRadio.checked) {
                    meetingLinkGroup.style.display = "block";
                    physicalVenue.style.display = "none";
                    addressGroup.style.display = "none";
                } else if (inPersonRadio.checked) {
                    meetingLinkGroup.style.display = "none";
                    physicalVenue.style.display = "block";
                    addressGroup.style.display = "block";
                }
            }

            function calculateDuration() {
                const start = startTimeInput.value;
                const end = endTimeInput.value;

                if (start && end) {
                    const startDate = new Date(`1970-01-01T${start}:00`);
                    const endDate = new Date(`1970-01-01T${end}:00`);
                    const diff = (endDate - startDate) / (1000 * 60); // minutes

                    if (diff > 0) {
                        const hours = Math.floor(diff / 60);
                        const minutes = diff % 60;
                        durationInfo.textContent = `Duration: ${hours}h ${minutes}m`;
                    } else {
                        durationInfo.textContent = "End time must be after start time";
                    }
                } else {
                    durationInfo.textContent = "Duration will be calculated automatically";
                }
            }

            function resetForm() {
                document.getElementById("sessionForm").reset();
                toggleVenue();
                durationInfo.textContent = "Duration will be calculated automatically";
            }

            // Event listeners
            onlineRadio.addEventListener("change", toggleVenue);
            inPersonRadio.addEventListener("change", toggleVenue);
            startTimeInput.addEventListener("change", calculateDuration);
            endTimeInput.addEventListener("change", calculateDuration);

            // Initial setup
            toggleVenue();
        });


        function editAnnounceCard(index, title, description, postedOn, visibility, links) {
            // Title
            document.getElementById(`title-${index}`).innerHTML = `
    <input type="text" id="edit-title-${index}" class="form-control" value="${title}" />
  `;

            // Description
            document.getElementById(`desc-${index}`).innerHTML = `
    <textarea id="edit-desc-${index}" class="form-control">${description}</textarea>
  `;

            // Meta (Posted On + Visibility)
            document.getElementById(`meta-${index}`).innerHTML = `
    üìÖ Posted on <input type="date" id="edit-date-${index}" class="form-control" style="display:inline-block; width:auto;" value="${formatDate(postedOn)}" /> ‚Ä¢ 
    üëÅÔ∏è Visible to: 
    <select id="edit-visibility-${index}" class="form-control" style="display:inline-block; width:auto;">
      <option ${visibility === 'All Users' ? 'selected' : ''}>All Users</option>
      <option ${visibility === 'Alumni' ? 'selected' : ''}>Alumni</option>
      <option ${visibility === 'Student' ? 'selected' : ''}>Student</option>
      <option ${visibility === 'Faculty' ? 'selected' : ''}>Faculty</option>
    </select>
  `;

            // Important Links
            document.getElementById(`links-${index}`).innerHTML = `
    üîó Important Links:
    <input type="text" id="edit-links-${index}" class="form-control" value="${links}" placeholder="Comma-separated URLs" />
  `;

            // Replace buttons with Save
            document.getElementById(`actions-${index}`).innerHTML = `
    <button class="btn btn-success btn-sm" onclick="saveAnnouncement(${index})">Save</button>
    <button class="btn btn-secondary btn-sm" style="margin-left: 8px;" onclick="cancelEdit(${index})">Cancel</button>
  `;
        }

        // Helper to format date to yyyy-mm-dd
        function formatDate(dateStr) {
            const date = new Date(dateStr);
            const yyyy = date.getFullYear();
            const mm = String(date.getMonth() + 1).padStart(2, '0');
            const dd = String(date.getDate()).padStart(2, '0');
            return `${yyyy}-${mm}-${dd}`;
        }

        // Placeholder save function
        function saveAnnouncement(index) {
            const updatedTitle = document.getElementById(`edit-title-${index}`).value;
            const updatedDesc = document.getElementById(`edit-desc-${index}`).value;
            const updatedDate = document.getElementById(`edit-date-${index}`).value;
            const updatedVisibility = document.getElementById(`edit-visibility-${index}`).value;
            const updatedLinks = document.getElementById(`edit-links-${index}`).value;

            console.log("Saving announcement:", {
                updatedTitle,
                updatedDesc,
                updatedDate,
                updatedVisibility,
                updatedLinks
            });

            // You can send this data to your backend via AJAX or form submission
        }

        // Optional cancel function
        function cancelEdit(index) {
            location.reload(); // Simple way to revert changes
        }

        // CREATING A FORM THROUGH JS TO UDATE IN TABLE
        function saveAnnouncement(index) {
            const form = document.createElement("form");
            form.method = "POST";
            form.action = `/announcement/update/${index}`;
            form.enctype = "multipart/form-data";

            const fields = {
                Title: document.getElementById(`edit-title-${index}`).value,
                Description: document.getElementById(`edit-desc-${index}`).value,
                Posted_On: document.getElementById(`edit-date-${index}`).value,
                Visibility: document.getElementById(`edit-visibility-${index}`).value,
                Important_Links: document.getElementById(`edit-links-${index}`).value
            };

            for (const key in fields) {
                const input = document.createElement("input");
                input.type = "hidden";
                input.name = key;
                input.value = fields[key];
                form.appendChild(input);
            }

            // File input
            const fileInput = document.getElementById(`edit-attachment-${index}`);
            if (fileInput && fileInput.files.length > 0) {
                form.appendChild(fileInput.cloneNode(true)); // clone and append
            }
            document.body.appendChild(form);
            form.submit(); // ‚úÖ Redirect happens automatically after server response
        }

        // DELETE ANNOUNCEMENTS
        function deleteAnnounceCard(id) {
            const form = document.createElement("form");
            form.method = "POST";
            form.action = `/announcement/delete/${id}`;
            document.body.appendChild(form);
            form.submit();
        }

        document.addEventListener("DOMContentLoaded", function () {
            const sessionCards = document.querySelectorAll("#sessions-section .content-section > div > div > div");

            sessionCards.forEach(card => {
                const rows = card.querySelectorAll("table tr");
                let modeText = "";
                let venueCell = null;

                rows.forEach(row => {
                    const cells = row.querySelectorAll("td");
                    if (cells.length === 2) {
                        if (cells[0].textContent.trim().startsWith("Mode:")) {
                            modeText = cells[0].textContent.trim().replace("Mode:", "").trim();
                        }
                        if (cells[1].textContent.trim().startsWith("Venue:")) {
                            venueCell = cells[1];
                        }
                    }
                });

                if (modeText === "Online" && venueCell) {
                    const link = card.getAttribute("data-join-link") || "<%=mentorshipSessions.Meeting_Link%>";
                    venueCell.innerHTML = `<strong>Joining Link:</strong> <a href="${link}" target="_blank">Join Session</a>`;
                }
            });
        });




        // FOR MENTORSHIP SESSIONS  
        function deleteSession(id) {
            const form = document.createElement("form");
            form.method = "POST";
            form.action = `/schedule-session/delete/${id}`;
            document.body.appendChild(form);
            form.submit();
        }
    </script>
</body>

</html>